<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000"></p-confirmDialog>
<h4 style="background: #E7E8E8;
padding: 10px 10px 10px 10px !important;
    font-size: 20px !important;
    color: #222b45;margin-left: 10px">
   Indicateurs de performance
</h4>
<div class="card" style=" margin: auto;margin-top:3%; border-color:#E7E8E8 !important; border:solid">
    <p-table #dt [value]="indicators" 
                dataKey="indicatorId" 
                styleClass="p-datatable-customers" 
                [rowHover]="true" 
                [rows]="5"
                [showCurrentPageReport]="true" 
                [rowsPerPageOptions]="[10,15]" 
                [loading]="loading" 
                [paginator]="true"
                currentPageReportTemplate="" 
                [filterDelay]="0"
                [globalFilterFields]="['indicatorName','indicatorAreaLabel','indicatorType','indicatorSens','createdAt', 'updatedAt']">
                
                <ng-template pTemplate="caption">
                    <div>
                        <div class="p-d-flex p-ai-center p-jc-between" style="width: 55%; display: inline-block">
                          <span class="p-input-icon-left" style="width: 100%">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" style=" width: 93%" class="searchInput, p-inputtext"
                              (input)="dt.filterGlobal($event.target.value, 'contains')"
                              placeholder="Chercher un indicateur.." />
                          </span>
                        </div>

                        <div style="float: right;">

                          <div style="display: flex">
                            <button pButton pRipple label="Ajouter" icon="pi pi-plus" class="primaryBtn" 
                            (click)="addIndicator()"  style="margin-right: 10px;"></button>

                            <p-fileUpload #form id="upload" mode="basic" icon="pi pi-file-excel"  [showCancelButton]="true" accept=".xls,.xlsx" [maxFileSize]="1000000" label="Choose" chooseLabel="Choisir un fichier Excel à importer" styleClass="primaryBtn" style="margin-right: 10px;" (onSelect)="selectFile($event,form)" (onBeforeUpload)="clear($event)"></p-fileUpload>

                        <button pButton pRipple *ngIf="showImportButton" label="Importer" icon="pi pi-file-excel" class="primaryBtn" (click)="importer()" ></button>
                          
                            
                        </div>
                    </div>

                  </div>


        </ng-template>
        <ng-template pTemplate="header">
            <tr style="text-align: center; font-size: 15px;">
                <th pSortableColumn="indicatorName" style="text-align: center; font-size: 13px;width: 25%">Libellé </th>
                <th pSortableColumn="indicatorArea.indicatorAreaLabel" style="text-align: center; font-size: 13px;width: 25%">Domaine </th>
                <th pSortableColumn="indicatorType" style="text-align: center; font-size: 13px;width: 20%">Type </th>
                <th pSortableColumn="indicatorSens" style="text-align: center; font-size: 13px;width: 20%">Sens </th>

            <th style="width: 10%;font-size: 13px; text-align: center;">Actions</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-indicator let-expanded="expanded">
            <tr class="p-selectable-row" style="text-align: center; font-size: 13px;">
               
                <td style="text-align: center;font-size: 13px;width: 15%">
                    {{indicator.indicatorName}}
                </td>
                <td style="text-align: center;font-size: 13px;width: 15%">
                    {{indicator.indicatorArea.indicatorAreaLabel}}
                </td>
                <td style="text-align: center;font-size: 13px;width: 15%">
                    {{indicator.indicatorType}} 
                </td>
                <td style="text-align: center;font-size: 13px;width: 15%">
                    {{indicator.indicatorSens}}
                </td>
            
                
                
                <td style="text-align: center;">
                    <div>
                      
                      <i  placement="top" ngbTooltip="Modifier" class="pi pi-pencil"
                        style="margin-right: 7px; color: #960032" (click)="editIndicator(indicator)"></i>
                      
                      <i placement="top" ngbTooltip="Supprimer" class="pi pi-trash" (click)="delIndicator(indicator)"
                        style="margin-right: 7px; color: #960032"></i>
                    
                    
                    </div>
                  </td>
               
            </tr>
        </ng-template>

</p-table>
</div>




<p-dialog header="Supprimer un indicateur" [(visible)]="displayDeleteIndicator" [modal]="true"
  [style]="{width: '50vw'}" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
  <br>
  <div>
    <span>La supression d'un indicateur va supprimer toutes les échelles relatives à cet indicateur</span>
  </div>
  <br>
  Voulez-vous toujours supprimer l'indicateur' <span
    class="customer-badge status-negotiation">{{indicator.indicatorName}}</span> ?
  <ng-template pTemplate="footer">
    <div style="margin-top: 20px;">
      <button pButton pRipple label="Annuler" icon="pi pi-times" class="p-button-secondary p-mr-2"
        (click)="displayDeleteIndicator=false"></button>

      <button pButton pRipple label="Supprimer" icon="pi pi-check" class="p-button-danger p-mr-2"
        (click)="deleteIndicator()"></button>

    </div>
  </ng-template>
</p-dialog>

<p-dialog header="{{HeaderIndicator}}" [(visible)]="displayIndicatorModal" [modal]="true"
  [style]="{width: '70%'}" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
 
  <ngx-add-new-indicator-performance  [performanceIndicator]="indicator" 
      (addNewIndicatorEvent)="saveIndicator($event)" 
      (cancelEvent)="hideIndicatorWindow(); initIndicator();">
  </ngx-add-new-indicator-performance>
</p-dialog>

