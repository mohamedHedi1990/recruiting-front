<h4 *ngIf="user.userId  == null" style="background: #E7E8E8; 
padding: 10px 10px 10px 10px !important;
    font-size: 20px !important;
    color: #222b45;margin-left: 10px">
Ajouter un nouveau utilisateur
</h4>
<h4 *ngIf="user.userId != null" style="background: #E7E8E8; 
padding: 10px 10px 10px 10px !important;
    font-size: 20px !important;
    color: #222b45;margin-left: 10px">
Modifier un utilisateur 
<span style="margin-left: 43%;color:#900C3F" class="customer-badge ">crée le {{user.createdAt }} -- modifié le {{user.updatedAt }}</span>
<div>
  <span class="customer-badge status-label">{{user.userLogin}}</span></div>
</h4>

<div style="width: 90%; margin: auto;margin-top:3%; border-color:#E7E8E8 !important; border:solid">
  <p-panel header="Informations génerales" [toggleable]="false">
      <div class="p-grid p-fluid">
        <div style="display: flex">
        <div class="mb-1 col-md-3 col-12 p-field">
         
         
        
              <div class="exemple1">
                <img *ngIf="imgURL!=null" [src]="imgURL" style="width:100%">
                <img  style="width:100%" *ngIf="imgURL2!=null" [src]="  sanitizer.bypassSecurityTrustResourceUrl(imgURL2)" style="width:191px">
                <i type="button" id="loadPhoto"  ngbTooltip="télécharger"  class="pi pi-camera"  onclick="document.getElementById('file').click();" style="margin-bottom: 3%;margin-left:117px" ></i>
                <input id="file" #file type="file" accept='image/*' (change)="preview(file.files)" style="display: none" />
              
              </div>
             
             
          
        </div>
        <div class="mb-1 col-md-9 col-12 p-field">
        <div style="display: flex">
         
          <div class="mb-1 col-md-6 col-12 p-field">
            <label for="userFirstName" class="p-float-label">Nom <strong style="color: #960032;">*</strong></label>
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>
              <input type="text" class="form-control p-field" id="userFirstName"
                     [(ngModel)]="user.userFirstName" [ngClass]="{
        
        'is-valid': user.userFirstName != null && user.userFirstName !== ''
      }">
            </div>
          </div>
          <div class="mb-1 col-md-6 col-12">
            <label for="userLastName" class="p-float-label">Prénom <strong style="color: #960032;">*</strong></label>
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>
              <input type="text" class="form-control p-field"  id="userLastName"
                     [(ngModel)]="user.userLastName " [ngClass]="{
        'is-valid': user.userLastName  != null && user.userLastName  !== ''
      }">
            </div>
          </div>
        </div>
      
      <div style="display: flex">
       
        <div class="mb-1 col-md-6 col-12 p-field">
          <label for="userGender" class="p-float-label">Genre <strong style="color: #960032;">*</strong></label>
          <div class="p-inputgroup">
            <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>

            <select
           
            [(ngModel)]="user.userGender"
            class="browser-default custom-select"
          >
              <option value="MADAME">Madame</option>
              <option value="MADEMOISELLE">Mademoiselle</option>
              <option value="MONSIEUR">Monsieur</option>
            </select>
          </div>
        </div>
        <div  class="mb-1 col-md-6 col-12 p-field">
          <label for="userCivilStatus" class="p-float-label">Etat civil <strong style="color: #960032;">*</strong></label>

          <div class="p-inputgroup">
            <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>

            <select
           
            [(ngModel)]="user.userCivilStatus"
            class="browser-default custom-select"
          >
              <option value="CELIBATAIRE">Célibataire</option>
              <option value="MARIE">Marié(e)</option>
              <option value="VEUF">Veuf(ve)</option>
            </select>
          </div>
        </div>
      </div>
      <div style="display: flex">
        <div class="mb-1 col-md-4 col-12 p-field">
          <label for="userBirthDate" class="p-float-label">Date de naissance <strong style="color: #960032;">*</strong></label>
          <div class="p-inputgroup">
            <span class="p-inputgroup-addon"><i class="pi pi-calendar"></i></span>
            <input type="date" class="form-control p-field" id="userBirthDate"
                   [(ngModel)]="user.userBirthDate" >
          </div>
        </div>
        
        <div class="mb-1 col-md-4 col-12 p-field">
          <label for="userBirthCountry" class="p-float-label"> Pays de naissance <strong style="color: #960032;">*</strong></label>
          <div class="p-inputgroup">
            <span class="p-inputgroup-addon"><i class="pi pi-flag"></i></span>
    <select [(ngModel)]="user.userBirthCountry" 
    class="browser-default custom-select" 
     (change)="changeCountry($event.target.value)">
        <option *ngFor ="let count of countriesList"> {{count.name}} </option>
    </select>
</div>
</div>
<div class="mb-1 col-md-4 col-12 p-field">
  <label for="userBirthCity" class="p-float-label"> Ville de naissance <strong style="color: #960032;">*</strong></label>
  <div class="p-inputgroup">
    <span class="p-inputgroup-addon"><i class="pi pi-home"></i></span>
<select [(ngModel)]="user.userBirthCity" 
class="browser-default custom-select" >
<option *ngFor ="let city of cities">{{city.name}} </option>
</select>
</div>
</div>

            
        </div>
    
      </div></div></div>
  </p-panel>
  <div style="margin-top: 1%; display: flex;">
    <div style="width: 40%">
      <p-panel header="Contacts" [toggleable]="false">
        <div class="p-grid p-fluid">
          <div style="display: flex">
            <div class="mb-1 col-md-12 col-12 p-field">
              <label for="userPhoneNumber" class="p-float-label">Numéro de téléphone <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-phone"></i></span>
                <!--<input type="number" class="form-control p-field" id="userPhoneNumber" [(ngModel)]="user.userPhoneNumber"
                  [ngClass]="{
            'is-valid': user.userPhoneNumber != null && user.userPhoneNumber!='' 
          }">
               -->
              <input type="text"
  ng2TelInput
  [ng2TelInputOptions]="{initialCountry: 'tn'}"
  (hasError)="hasError($event)"
  (ng2TelOutput)="getNumber($event)"
  (intlTelInputObject)="telInputObject($event)"
  (countryChange)="onCountryChange($event)" class="form-control p-field" id="userPhoneNumber" [(ngModel)]="user.userPhoneNumber"
  (keyup)="CheckTelHasError=null" 
  [ngClass]="{
    'is-valid': CheckTelHasError==true 
}" /></div> 
            </div>
          </div>
          <div style="display: flex">
            <div class="mb-1 col-md-12 col-12 p-field">
              <label for="userEmail" class="p-float-label">Mail <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-envelope"></i></span>
               
                <input type="email" pattern="/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/" (keyup)="checkMail()" required class="form-control p-field" id="userEmail" [(ngModel)]="user.userEmail"
                  [ngClass]="{
                    'is-invalid' : checkEmail== false ,
            'is-valid': checkEmail== true && user.userEmail!=null
          }">
              </div>
            </div>
          
          </div>
          <div style="display: flex">
            <div class="mb-1 col-md-12 col-12 p-field">
              <label for="userAddress" class="p-float-label">N° et Rue <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>
                <input type="text" class="form-control p-field" id="userAddress" [(ngModel)]="adresse.nRue">
              </div>
            </div>
          </div>
          <div style="display: flex">
            <div class="mb-1 col-md-12 col-12 p-field">
              <label for="userAddress" class="p-float-label">Pays <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>
                <input type="text" class="form-control p-field" id="userAddress" [(ngModel)]="adresse.pays">
              </div>
            </div>
          </div>
          <div style="display: flex">
            <div class="mb-1 col-md-12 col-12 p-field">
              <label for="userAddress" class="p-float-label">Ville  <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-tag"></i></span>
                <input type="text" class="form-control p-field" id="userAddress" [(ngModel)]="adresse.ville">
              </div>
            </div>
          </div>
        </div>
      </p-panel>
    </div>

    <div style="width: 60%">
      
      <div>
        <p-panel  header="Informations d'embauche" [toggleable]="false">
          <div style="margin-top: 4%;" class="p-grid p-fluid" >
            <div style="display: flex">
              <div class="mb-1 col-md-6 col-12 p-field">
                <label for="userHirringDate" class="p-float-label">Date d’embauche <strong style="color: #960032;">*</strong></label>
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon"><i class="pi pi-calendar"></i></span>
                  <input type="date" class="form-control p-field" id="userHirringDate"
                         [(ngModel)]="user.userHirringDate" >
                </div>
              </div>
            
            
              <div class="mb-1 col-md-6 col-12 p-field">
                <label for="userRegistrationNumber" class="p-float-label">Matricule <strong style="color: #960032;">*</strong></label>
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon"><i class="pi pi-bars"></i></span>
                  <input type="text" class="form-control p-field" id="userRegistrationNumber"
                         [(ngModel)]="user.userRegistrationNumber" [ngClass]="{
            'is-valid': user.userRegistrationNumber != null && user.userRegistrationNumber !== ''
          }">
                </div>
              </div>
              
              <br><br><br><br><br>
            </div>
          </div>
          
        </p-panel>
      </div>
    
    <div style="margin-top: 1%;">
      <p-panel header="Identifants d'accés" [toggleable]="false">
        <div class="p-grid p-fluid">
          <div style="display: flex">
            <div class="mb-1 col-md-6 col-12">
              <label for="userLogin" class="p-float-label">Login <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-user"></i></span>
                <input type="text" class="form-control p-field"  id="userLogin"
                       [(ngModel)]="user.userLogin " [ngClass]="{
          'is-valid': user.userLogin  != null && user.userLogin  !== ''
        }">
              </div>
            </div>
        
         
            
            <div  class="mb-1 col-md-4 col-12">
              <label for="userPassword" class="p-float-label">Mot de passe <strong style="color: #960032;">*</strong></label>
              <div class="p-inputgroup">
                <span class="p-inputgroup-addon"><i class="pi pi-lock"></i></span>
                <input type="text" disabled class="form-control p-field"  id="userPassword"
                       [(ngModel)]="user.userPassword ">
              </div>
              
              
  
               </div>
               <div  class="mb-1 col-md-2 col-12" style="padding-top: 18px;">
                <label for="userPassword" class="p-float-label"></label>
                <div  style="width: 80px;" class="p-inputgroup">
                  <button  pButton pRipple label="Générer" style=" padding-top: 18px;
                  padding: 5px;
                  width: 62px;"  class="primaryBtn" 
          (click)="generatePassword()" placement="top" ngbTooltip="Générer un mot de passe"></button>
    
                </div>
                
                 </div>
                 <br><br><br><br><br>
          </div>
        </div>
        
      </p-panel>
    </div>
    </div>
    
    </div>
    
  

 

  <div class="p-panel p-panel-header" style="margin-top: 20px;float: right; padding: 2%;">

    <button  pButton pRipple label="Annuler" icon="pi pi-times" class="btn btn-secondary" (click)="cancel()"></button>

      <button [disabled]="checkUserValid()"
      [ngClass]= "{'disabled':  checkUserValid()}" pButton pRipple label="Enregistrer" icon="pi pi-check" class="primaryBtn" 
      (click)="saveUser()" style="margin-left: 10px;"></button>
  </div>

</div>
